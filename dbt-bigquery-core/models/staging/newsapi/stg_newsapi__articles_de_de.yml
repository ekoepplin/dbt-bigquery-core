version: 2

models:
  - name: stg_newsapi__articles_de_de
    description: "Staged German articles from NewsAPI"
    tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref('src_newsapi__articles_de_de')
          config:
            severity: warn
    columns:
      - name: source_name
        description: "Name of the news source"
        tests:
          - not_null
      - name: author
        description: "Author of the article"
      - name: title
        description: "Title of the article"
        tests:
          - not_null
          - unique
      - name: description
        description: "Description or summary of the article"
      - name: url
        description: "URL to the article"
        tests:
          - not_null
          - unique
          - dbt_expectations.expect_column_values_to_match_regex:
              regex: '^https?://.*$'
      - name: image_url
        description: "URL to the article's image"
        tests:
          - dbt_expectations.expect_column_values_to_match_regex:
              regex: '^https?://.*$'
              config:
                severity: warn
      - name: published_at
        description: "Publication date and time"
        tests:
          - not_null
          - dbt_expectations.expect_column_values_to_be_of_type:
              column_type: timestamp
      - name: content
        description: "Article content"
      - name: language_code
        description: "Language code (de)"
        tests:
          - not_null
          - accepted_values:
              values: ['de']
      - name: _dlt_load_id
        description: "Load ID from data loading tool"
        tests:
          - not_null
          - relationships:
              to: ref('src_newsapi__articles_de_de')
              field: _dlt_load_id
      - name: _dlt_id
        description: "Unique ID from data loading tool"
        tests:
          - not_null
          - unique 